---
title: Referrer=never 引发的惨案
date: 2018-06-25 22:27:01
tags: ['教训', 'HTTP', 'referrer']
---

## 教训

在某次项目中，需要在页面上展示公众号的二维码，而这个二维码的获取，是通过将公众号授权给我们的第三方平台服务时，后端存在数据库中的，形如[http://mmbiz.qpic.cn/mmbiz_jpg/xxx](http://mmbiz.qpic.cn/mmbiz_jpg/xxx)，网络上有一种解法：在中设置`referrer=never`，然后我就屁颠屁颠的照着做了。但是，结果并不尽人意。最后在上线的时候还忘记撤销了，结果引发了一桩惨案：导致了线上的百度统计无法统计到正确的数据。

**这个里边有一个大坑**，慎用

## referrer有什么用

在页面引入图片、JS等资源的时，浏览器会在请求头中添加 `referrer` 字段，标记这次请求的来源。有些网站会使用 `referrer` 这个字段来实现防盗链。在百度统计之类的第三方统计服务中，`referrer` 是一个相当重要的字段，很多的数据，比如：页面间的跳转，页面来源等，都是通过这个字段来统计的。

因此，使用 hack 的方法寻求的解决方案，大部分时候都会导致意想不到的灾难。
